/*
ARIA Data Grid Module R1.2
Copyright 2010-2014 Bryan Garaventa (WhatSock.com)
Part of AccDC, a Cross-Browser JavaScript accessibility API, distributed under the terms of the Open Source Initiative OSI - MIT License
*/
(function(c){var b="grid"+$A.genId(),d=1;$A.DataGrid=function(f){var i=this,f=typeof f==="string"?$A.getEl(f):f,e=function(m){return m&&typeof m==="object"&&typeof m.length==="number"&&typeof m.splice==="function"&&!(m.propertyIsEnumerable("length"))},g={gridClass:"data-grid",gridReadOnlyClass:"data-grid-readonly",cellReadOnlyClass:"data-grid-cell-readonly",gridEditableClass:"data-grid-editable",gridSelectableClass:"data-grid-selectable",gridRowClass:"data-grid-row",gridCellClass:"data-grid-cell",gridCellToggleClass:"data-grid-cell-toggle",gridCellTogglePressedClass:"data-grid-cell-toggle-pressed",gridCellLinkClass:"data-grid-cell-link",gridRowFocusedClass:"data-grid-row-focused",gridCellFocusedClass:"data-grid-cell-focused",editFieldClass:"data-grid-cell-link-edit",edit:false,colHeaders:{map:[]},rowHeaders:{enabled:false,id:null},page:{row:{max:0,collectionMap:[],collection:{},toggleButtonRole:"Toggle Button",toggleButtonState:"Pressed",disabledText:"Disabled",editLinkAction:"Editable",build:function(n){d++;var m=b+"tr"+d;n.rowNodeId=m;n.rowNode=$A.createEl("tr",{role:"row",id:m},null,g.gridRowClass);for(id in n.cells){d++;var o=b+"td"+d;n.cells[id].id=id;n.cells[id].cellNodeId=o;n.cells[id].data={};n.cells[id].cellNode=$A.createEl("td",{id:o},null,g.gridCellClass);g.page.row.bindCell(n.cells[id],n.cells[id].cellNode,n,n.rowNode);n.cells[id].cellNodeA=$A.createEl("strong",{id:o+"a"},null,n.cells[id].type=="toggle"?g.gridCellToggleClass:g.gridCellLinkClass);n.cells[id].cellNodeS1=$A.createEl("span");n.cells[id].cellNodeS2=$A.createEl("span",null,$A.sraCSS);n.cells[id].cellNodeS3=$A.createEl("span",null,$A.sraCSS);n.cells[id].cellNode.appendChild(n.cells[id].cellNodeA);n.cells[id].cellNodeA.appendChild(n.cells[id].cellNodeS1);n.cells[id].cellNodeA.appendChild(n.cells[id].cellNodeS2);n.cells[id].cellNodeA.appendChild(n.cells[id].cellNodeS3);n.cells[id].rowObject=n;c.data(n.cells[id].cellNode,"celldata",{rowId:n.id,rowNodeId:n.rowNodeId,cellId:id,cellNodeId:n.cells[id].cellNodeId})}c.data(n.rowNode,"rowdata",{rowId:n.id,rowNodeId:n.rowNodeId})},trackPos:{row:0,col:0},resetPos:function(m){var o=c.data(m,"celldata");g.page.row.trackPos.row=$A.inArray(o.rowId,g.page.rendered)||0;for(var n=0;n<g.colHeaders.map.length;n++){if(o.cellId==g.colHeaders.map[n].id){g.page.row.trackPos.col=n;break}}return o},dblClickTitle:"Click to activate",editFieldTitle:"Press Enter to save, or Escape to cancel.",cellOffset:function(m){var n=$A.xOffset(m.cellNodeA);n.height=$A.xHeight(m.cellNodeA);n.width=$A.xWidth(m.cellNodeA);return n},bindCell:function(o,m,s,p){var n=function(){m=o.cellNode;s=o.rowObject;p=o.rowObject.rowNode;if(g.edit&&!o.readonly){if(o.type=="toggle"){g.page.row.changed(m,o,o.value?false:true)}else{if(g.page.row.editFieldActive){l()}g.page.row.editFieldActive=o;$A.bind(g.page.row.editField,{"keydown.gridcontrol":function(v){var u=v.which||v.keyCode;if(u==13||u==27||u==9){v.preventDefault();if(u==13){g.page.row.changed(m,g.page.row.editFieldActive,this.value)}l(true)}},"blur.gridcontrol":function(u){u.preventDefault()}});g.page.row.editField.value=o.value;$A.setAttr(g.page.row.editField,{title:g.page.row.editFieldTitle});$A.query("body > *",function(u,v){$A.setAttr(v,"aria-hidden","true")});document.body.appendChild(g.page.row.editFieldDiv);$A.css(g.page.row.editFieldDiv,g.page.row.cellOffset(o));g.page.row.editField.focus();if(g.page.row.editLoad&&typeof g.page.row.editLoad==="function"){g.page.row.editLoad.apply(g.page.row.editField,[g.page.row.editField,o])}}}else{if(g.page.row.selectEnabled){var t=s.selected;if(!g.page.row.multiSelect){g.page.row.unselectAll()}if(!t||g.page.row.multiSelect){g.page.row.select(o)}if(!g.page.row.ariaSelect){$A.announce(o.cellNode)}}}},r=function(u,w){m=o.cellNode;s=o.rowObject;p=o.rowObject.rowNode;if(u==33){if(q.alt){g.page.first(o,s)}else{g.page.prev(o,s)}}else{if(u==34){if(q.alt){g.page.last(o,s)}else{g.page.next(o,s)}}else{if(u>=35&&u<=40){var t=false,v=g.page.rendered.length-1,x=g.colHeaders.map.length-1;if(u==35&&q.ctrl&&g.page.current<g.page.total){g.page.last(o,s,true);return}else{if(u==35&&q.ctrl&&g.page.current==g.page.total){g.page.row.trackPos.row=v;t=true}else{if(u==35&&g.page.row.trackPos.col<x){g.page.row.trackPos.col=x;t=true}else{if(u==36&&q.ctrl&&g.page.current>1){g.page.first(o,s);return}else{if(u==36&&q.ctrl&&g.page.current==1){g.page.row.trackPos.row=0;t=true}else{if(u==36&&g.page.row.trackPos.col>0){g.page.row.trackPos.col=0;t=true}else{if(u==37&&g.page.row.trackPos.col>0){g.page.row.trackPos.col-=1;t=true}else{if(u==38&&g.page.row.trackPos.row>0&&q.alt){g.page.row.trackPos.row=0;t=true}else{if(u==38&&g.page.row.trackPos.row>0){g.page.row.trackPos.row-=1;t=true}else{if(u==38&&g.page.row.trackPos.row==0){g.page.prev(o,s,true);return}else{if(u==39&&g.page.row.trackPos.col<x){g.page.row.trackPos.col+=1;t=true}else{if(u==40&&g.page.row.trackPos.row<v&&q.alt){g.page.row.trackPos.row=v;t=true}else{if(u==40&&g.page.row.trackPos.row<v){g.page.row.trackPos.row+=1;t=true}else{if(u==40&&g.page.row.trackPos.row>=v){g.page.next(o,s);return}}}}}}}}}}}}}}if(t){g.page.row.move({rowId:g.page.rendered[g.page.row.trackPos.row],cellId:g.colHeaders.map[g.page.row.trackPos.col].id})}}}}};var q={ctrl:false,alt:false};$A.bind(m,{"click.gridcontrol":function(v){var u=v.srcElement||v.target;if(u!=this||this!=g.page.row.focusedCell){g.page.row.move(g.page.row.resetPos(this))}if("ontouchstart" in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0){o=j(this);n()}v.preventDefault()},"dblclick.gridcontrol":function(t){if(k){if(this!=g.page.row.focusedCell){g.page.row.move(g.page.row.resetPos(this))}if(!("ontouchstart" in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){o=j(this);n()}t.stopPropagation();t.preventDefault()}},"mouseup.gridcontrol":function(t){if(!k){if(!t.which&&t.button&&t.button&1){t.which=1}if(t.which===1){if(this!=g.page.row.focusedCell){g.page.row.move(g.page.row.resetPos(this))}if(!("ontouchstart" in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){o=j(this);n()}t.stopPropagation();t.preventDefault()}}},"keydown.gridcontrol":function(v){var t=v.which||v.keyCode;q.ctrl=v.ctrlKey;q.alt=v.altKey;if((t>=33&&t<=40)||t==13||t==32||t==46||t==65){o=j(this);if(t==13||t==32){if(t==32&&q.ctrl){var x="";for(var u=0;u<g.colHeaders.map.length;u++){var w=g.colHeaders.map[u];x+=$A.getText(o.rowObject.cells[w.id].cellNode)+", "}$A.announce(x)}else{n()}}else{if(t>=33&&t<=40){r(t,v)}else{if(t==46&&g.page.row.deleteRow.enabled){g.page.row.deleteRow.callback();g.page.row.move()}else{if(t==65&&q.ctrl&&g.page.row.selectEnabled){g.page.row.selectAll();$A.announce(g.page.row.selectState)}}}}v.preventDefault()}},"keyup.gridcontrol":function(t){q.ctrl=false;q.alt=false},"focus.gridcontrol":function(t){o=j(this);$A.addClass(this,g.gridCellFocusedClass);$A.addClass(o.rowObject.rowNode,g.gridRowFocusedClass);if(this!=g.page.row.focusedCell){g.page.row.move(g.page.row.resetPos(this),true)}},"blur.gridcontrol":function(t){$A.query("tr."+g.gridRowFocusedClass+", td."+g.gridCellFocusedClass,g.dc.containerDiv,function(u,v){$A.remClass(v,g.gridRowFocusedClass+" "+g.gridCellFocusedClass)})}})},clean:function(o,m){$A.remAttr(o.rowNode,["title","aria-selected","aria-rowindex","aria-owns"]);$A.remClass(o.rowNode,g.gridRowFocusedClass+" "+g.page.row.selectClass);if(!m){c.removeData(o.rowNode,"rowdata")}for(var p in o.cells){$A.remAttr(o.cells[p].cellNode,["aria-labelledby","aria-describedby","tabindex","aria-colindex","aria-selected","aria-readonly"]);$A.remClass(o.cells[p].cellNode,g.cellReadOnlyClass+" "+g.gridCellFocusedClass+" "+(o.cells[p].toggleClass||g.gridCellTogglePressedClass));$A.remAttr(o.cells[p].cellNodeA,["title",]);o.cells[p].cellNodeS1.innerHTML="";o.cells[p].cellNodeS2.innerHTML="";o.cells[p].cellNodeS3.innerHTML="";if(!m){c.removeData(o.cells[p].cellNode,"celldata")}}},changed:function(m,o,p){var n=g.page.row.changed.cb&&typeof g.page.row.changed.cb==="function"?g.page.row.changed.cb.apply(m,[o,p,o.rowObject,i]):true;if(typeof n!=="boolean"){n=true}if(n){g.page.row.update(o.rowObject.id,o.id,p)}},selectEnabled:false,selectState:"Selected",selectClass:"selected",multiSelect:false,preserveSelect:false,ariaSelect:false,selected:[],select:function(r,m){var q=m||(r.rowObject.selected?false:true),p=g.page.row.select.cb&&typeof g.page.row.select.cb==="function"?g.page.row.select.cb.apply(r.rowObject.rowNode,[r.rowObject,q,g.page.row.selected,i]):true;if(typeof p!=="boolean"){p=true}if(p){r.rowObject.selected=q;var t=false;for(var s=g.page.row.selected.length-1;s>=0;s--){if(g.page.row.selected[s]===r.rowObject.id&&!r.rowObject.selected){g.page.row.selected.splice(s,1)}else{if(g.page.row.selected[s]===r.rowObject.id&&r.rowObject.selected){t=true}}}if(!t&&r.rowObject.selected){g.page.row.selected.push(r.rowObject.id)}var n=$A.inArray(r.rowObject.id,g.page.rendered)!==-1;if(n){var o="";if(r.rowObject.selected){$A.addClass(r.rowObject.rowNode,g.page.row.selectClass);o=g.page.row.selectState?g.page.row.selectState+". ":""}else{$A.remClass(r.rowObject.rowNode,g.page.row.selectClass)}o+=g.page.row.dblClickTitle;$A.setAttr(r.rowObject.rowNode,"title",o);if(g.page.row.ariaSelect){$A.setAttr(r.rowObject.rowNode,"aria-selected",r.rowObject.selected?"true":"false")}for(var s=0;s<g.colHeaders.map.length;s++){if(g.page.row.ariaSelect){$A.setAttr(r.rowObject.cells[g.colHeaders.map[s].id].cellNode,"aria-selected",r.rowObject.selected?"true":"false")}else{r.rowObject.cells[g.colHeaders.map[s].id].cellNodeS3.innerHTML=r.rowObject.selected?"<span>&nbsp;"+a(g.page.row.selectState)+"</span>":""}}}}},unselectAll:function(){for(var m=g.page.row.selected.length-1;m>=0;m--){var n=g.page.row.selected[m];g.page.row.select(g.page.row.collection[n].cells[g.colHeaders.map[0].id],false);g.page.row.selected.splice(m,1)}},selectAll:function(){if(g.page.row.selectEnabled&&g.page.row.multiSelect){if(!g.page.row.preserveSelect){g.page.row.unselectAll()}for(var m=0;m<g.page.rendered.length;m++){g.page.row.select(g.page.row.collection[g.page.rendered[m]].cells[g.colHeaders.map[0].id],true)}}},deleteRow:{enabled:false,callback:function(m){var r=g.page.row.deleteRow.callback.runBefore&&typeof g.page.row.deleteRow.callback.runBefore==="function"?g.page.row.deleteRow.callback.runBefore.apply(i,[m&&m.length?m:g.page.row.selected]):true;if(typeof r!=="boolean"){r=true}if(!r){return false}var o=[];if(m&&m.length){g.page.row.unselectAll();for(var s=0;s<m.length;s++){if(g.page.row.collection[m[s]]&&g.page.row.collection[m[s]].cells){g.page.row.selected.push(m[s])}}}var t=g.page.row.selected.length;for(var s=g.page.row.selected.length-1;s>=0;s--){var u=g.page.row.collection[g.page.row.selected[s]],w=$A.inArray(u.id,g.page.row.collectionMap);if(w!==-1){var v=g.page.row.deleteRow.callback.cb&&typeof g.page.row.deleteRow.callback.cb==="function"?g.page.row.deleteRow.callback.cb.apply(u.rowNode,[u,i]):true;if(typeof v!=="boolean"){v=true}if(v){o.push(u.id);g.page.row.clean(u);for(var p in u.cells){c(u.cells[p].cellNode).remove()}c(u.rowNode).remove();var q=$A.inArray(u.id,g.page.rendered);if(q!==-1){g.page.rendered.splice(q,1)}g.page.row.selected.splice(s,1);g.page.row.collectionMap.splice(w,1);delete g.page.row.collection[u.id]}}}if(t!=g.page.row.selected.length){g.page.row.trackPos.row=0;g.page.sync();g.page.open(g.page.current);if(g.page.row.deleteRow.callback.runAfter&&typeof g.page.row.deleteRow.callback.runAfter==="function"){g.page.row.deleteRow.callback.runAfter.apply(i,[o])}return true}return false}},update:function(r,q,t,m){if(!g.page.row.collection[r]||!g.page.row.collection[r].cells[q]){return}var n=g.page.row.collection[r].cells[q],o=n.type;g.page.row.collection[r].cells[q].value=o=="toggle"?(t?true:false):t;var s=$A.inArray(r,g.page.rendered);if(s!==-1){if(o=="toggle"){var p="&nbsp;"+a(g.page.row.toggleButtonRole);if(t){$A.addClass(n.cellNodeA,n.toggleClass||g.gridCellTogglePressedClass);p+="&nbsp;"+a(g.page.row.toggleButtonState)}else{$A.remClass(n.cellNodeA,n.toggleClass||g.gridCellTogglePressedClass)}if(n.readonly||g.page.row.selectEnabled||!g.edit){p+="&nbsp;"+a(g.page.row.disabledText)}n.cellNodeS2.innerHTML="<span>"+p+"</span>"}else{n.cellNodeS1.innerHTML="<span>"+a(t)+"</span>"}if(!m){$A.announce(n.cellNodeA)}}},focusedCell:null,move:function(q,n){if(!q&&g.page.row.focusedCell){setTimeout(function(){g.page.row.focusedCell.focus()},1);return}var m=g.page.row.focusedCell,p=g.page.row.collection[q.rowId].cells[q.cellId].cellNode;if(m&&m!=p){$A.setAttr(m,"tabindex","-1")}g.page.row.focusedCell=p;g.page.row.resetPos(p);$A.setAttr(p,"tabindex","0");if(!n){p.focus()}if(g.page.row.move.cb&&typeof g.page.row.move.cb==="function"){g.page.row.move.cb.apply(p,[p,m,g.dc,i])}}},pageRole:"Page",current:1,total:1,sync:function(s){var x=g.page.current,z=g.page.total;if(!g.page.row.max||!g.page.row.collectionMap.length){g.page.current=g.page.total=1}else{var m=g.page.row.max,v=g.page.row.collectionMap.length;if(m>=v){g.page.current=g.page.total=1}else{var q=Math.ceil(v/m);g.page.total=q;if(g.page.current>q){g.page.current=q}}}var o=[];if(s){if(s>g.page.row.total){s=g.page.row.total}var y=(s-1)*g.page.row.max,w=y+g.page.row.max;g.page.current=s;if(!g.page.row.max){w=g.page.row.collectionMap.length}for(var A=y;A<w;A++){var t=g.page.row.collectionMap[A];if(!(isNaN(t)&&!t)){g.page.row.collection[t].rowIndex=A+1;o.push(t)}}}if(x!=g.page.current||z!=g.page.total){if(g.page.indexChanged&&typeof g.page.indexChanged==="function"){g.page.indexChanged.apply(i,[g.page.current,g.page.total,i])}}if(s){return o}},on:{open:null,close:null,change:null,add:null,rem:null},open:function(p,o){if(g.page.row.editFieldActive){l(true,true)}if(isNaN(p)||p<1){p=1}if(o&&g.dc.loaded){g.page.close()}var m=g.dc.loaded;if(!m){g.dc.open()}g.page.render(g.page.sync(p));if(!m&&g.page.on.open&&typeof g.page.on.open==="function"){g.page.on.open.apply(f,[f,g.dc,i])}},close:function(){if(g.page.row.editFieldActive){l(true,true)}if(g.page.on.close&&typeof g.page.on.close==="function"){g.page.on.close.apply(f,[f,g.dc,i])}g.page.row.unselectAll();g.page.removeRendered();g.dc.close()},rendered:[],removeRendered:function(){if(!g.page.row.preserveSelect){g.page.row.unselectAll()}for(var m=0;m<g.page.rendered.length;m++){var q=g.page.rendered[m],o=g.page.row.collection[q];g.page.row.clean(o,true);if(g.page.on.rem&&typeof g.page.on.rem==="function"){g.page.on.rem.apply(o.rowNode,[o,g.dc,i])}for(var p in o.cells){if(o.cells[p].cellNode.parentNode){o.cells[p].cellNode.parentNode.removeChild(o.cells[p].cellNode)}}o.rowNode.parentNode.removeChild(o.rowNode)}g.page.rendered=[]},render:function(m){if(g.page.row.editFieldActive){l(true,true)}if(g.page.row.selectEnabled&&g.edit){g.edit=false}if(!g.dc.loaded){return}if(g.page.rendered.length){g.page.removeRendered()}g.page.rendered=m;var z={},w=[];for(var s=0;s<m.length;s++){d++;var x=g.page.row.collection[m[s]].rowNode,y=1,q=g.page.row.collection[m[s]].selected,t=q?g.page.row.selectState+". ":"";$A.addClass(x,g.gridRowClass);w.push(g.page.row.collection[m[s]].rowNodeId);if(g.page.row.selectEnabled){$A.setAttr(x,{title:t+g.page.row.dblClickTitle});if(g.page.row.ariaSelect){$A.setAttr(x,{"aria-selected":q?"true":"false"})}if(q){$A.addClass(x,g.page.row.selectClass)}}$A.setAttr(x,"aria-rowindex",g.page.row.collection[m[s]].rowIndex);var v=[];for(var r=0;r<g.colHeaders.map.length;r++){d++;var p=g.colHeaders.map[r],n=g.page.row.collection[m[s]].cells[p.id];$A.addClass(n.cellNode,g.gridCellClass);v.push(n.cellNodeId);if(p.colClass){$A.addClass(n.cellNode,p.colClass)}$A.setAttr(n.cellNode,{role:"gridcell","aria-colindex":y,"aria-labelledby":n.cellNodeId+"a","aria-describedby":g.rowHeaders.enabled&&g.rowHeaders.id&&g.rowHeaders.id!=n.id&&n.rowObject.cells[g.rowHeaders.id]?n.rowObject.cells[g.rowHeaders.id].cellNodeId+" "+p.thId:p.thId,tabindex:"-1"});if(g.rowHeaders.enabled&&g.rowHeaders.id&&g.rowHeaders.id==n.id){$A.setAttr(n.cellNode,{role:"rowheader",scope:"row"})}if(g.page.row.selectEnabled){if(n.type=="toggle"&&(g.page.row.toggleButtonRole||g.page.row.toggleButtonState)){var t=n.value?g.page.row.toggleButtonRole+" "+g.page.row.toggleButtonState:g.page.row.toggleButtonRole;$A.setAttr(n.cellNodeA,"title",t)}if(g.page.row.ariaSelect){$A.setAttr(n.cellNode,"aria-selected",q?"true":"false")}else{if(q){n.cellNodeS3.innerHTML=q?"<span>&nbsp;"+a(g.page.row.selectState)+"</span>":""}}}else{if(g.edit&&!n.readonly){var t="";if(n.type=="toggle"&&(g.page.row.toggleButtonRole||g.page.row.toggleButtonState)){t=n.value?g.page.row.toggleButtonRole+" "+g.page.row.toggleButtonState:g.page.row.toggleButtonRole;t+=". "}else{if(g.page.row.editLinkAction){t=g.page.row.editLinkAction+". "}}$A.setAttr(n.cellNodeA,"title",t+g.page.row.dblClickTitle)}else{if(n.type=="toggle"&&(g.page.row.toggleButtonRole||g.page.row.toggleButtonState)){var t=n.value?g.page.row.toggleButtonRole+" "+g.page.row.toggleButtonState:g.page.row.toggleButtonRole;$A.setAttr(n.cellNodeA,"title",t)}}}if(s===g.page.row.trackPos.row&&r===g.page.row.trackPos.col){z={rowId:m[s],cellId:p.id}}if(n.readonly||g.page.row.selectEnabled){$A.addClass(n.cellNode,g.cellReadOnlyClass)}if(n.type=="toggle"){n.cellNodeS1.innerHTML="<span>"+a(n.name)+"</span>";var u="&nbsp;"+a(g.page.row.toggleButtonRole);if(n.value){$A.addClass(n.cellNodeA,n.toggleClass||g.gridCellTogglePressedClass);u+="&nbsp;"+a(g.page.row.toggleButtonState)}else{$A.remClass(n.cellNodeA,n.toggleClass||g.gridCellTogglePressedClass)}if(n.readonly||g.page.row.selectEnabled||!g.edit){u+="&nbsp;"+a(g.page.row.disabledText)}n.cellNodeS2.innerHTML="<span>"+u+"</span>"}else{n.cellNodeS1.innerHTML="<span>"+a(n.value)+"</span>";if(g.edit&&!n.readonly){var u="&nbsp;"+a(g.page.row.editLinkAction);n.cellNodeS2.innerHTML="<span>"+u+"</span>"}}x.appendChild(n.cellNode);y+=1}$A.setAttr(x,"aria-owns",v.join(" "));g.dc.tbody.appendChild(x);if(g.page.on.add&&typeof g.page.on.add==="function"){g.page.on.add.apply(x,[g.page.row.collection[m[s]],g.dc,i])}}$A.setAttr(g.dc.tbody,"aria-owns",w.join(" "));if("rowId" in z&&"cellId" in z){g.page.row.move(z,true)}},prev:function(m,o,n){if(g.page.current>1){g.page.render(g.page.sync(g.page.current-1));g.page.row.move({rowId:g.page.rendered[n?g.page.rendered.length-1:0],cellId:m.id});$A.announce(g.page.pageRole+" "+g.page.current);if(g.page.on.change&&typeof g.page.on.change==="function"){g.page.on.change.apply(f,[g.page.current,g.page.total,i])}}},next:function(m,n){if(g.page.current<g.page.total){g.page.render(g.page.sync(g.page.current+1));g.page.row.move({rowId:g.page.rendered[0],cellId:m.id});$A.announce(g.page.pageRole+" "+g.page.current);if(g.page.on.change&&typeof g.page.on.change==="function"){g.page.on.change.apply(f,[g.page.current,g.page.total,i])}}},first:function(m,n){if(g.page.current>1){g.page.render(g.page.sync(1));g.page.row.move({rowId:g.page.rendered[0],cellId:m.id});$A.announce(g.page.pageRole+" "+g.page.current);if(g.page.on.change&&typeof g.page.on.change==="function"){g.page.on.change.apply(f,[g.page.current,g.page.total,i])}}},last:function(n,o,m){if(g.page.current<g.page.total){g.page.render(g.page.sync(g.page.total));g.page.row.move({rowId:m?g.page.rendered[g.page.rendered.length-1]:g.page.rendered[0],cellId:n.id});$A.announce(g.page.pageRole+" "+g.page.current);if(g.page.on.change&&typeof g.page.on.change==="function"){g.page.on.change.apply(f,[g.page.current,g.page.total,i])}}}}};d++;var h=b+"u"+d,j=function(m){var n=c.data(m||g.page.row.focusedCell,"celldata");return g.page.row.collection[n.rowId].cells[n.cellId]};g.page.row.editMaxLength=255;g.page.row.editFieldDiv=$A.createEl("div",{role:"application"},null,g.editFieldClass);g.page.row.editField=$A.createEl("input",{type:"text",maxlength:g.page.row.editMaxLength},null,g.editFieldClass);g.page.row.editFieldDiv.appendChild(g.page.row.editField);$A.bind(window,"resize."+h,function(){if(g.page.row.editFieldActive){$A.css(g.page.row.editFieldDiv,g.page.row.cellOffset(g.page.row.editFieldActive))}});var l=function(n,m){g.page.row.editField.value="";$A.unbind(g.page.row.editField,".gridcontrol");c(g.page.row.editFieldDiv).remove();if(n){g.page.row.editFieldActive=null;$A.query("body > *",function(p,q){$A.setAttr(q,"aria-hidden","false");$A.remAttr(q,"aria-hidden")});if(!m){g.page.row.move()}}};$A([{id:h,role:"Grid",showHiddenBounds:false,isStatic:f,runAfter:function(m){d++;m.tableId=b+"t"+d;m.theadId=b+"tth"+d;m.trId=b+"tthtr"+d;m.tbodyId=b+"ttb"+d;m.table=$A.createEl("table",{role:"grid",id:m.tableId,"aria-owns":m.theadId+" "+m.tbodyId},null,g.gridClass);if(g.edit){$A.addClass(m.table,g.gridEditableClass)}else{if(g.page.row.selectEnabled){$A.addClass(m.table,g.gridSelectableClass)}else{if(!g.edit&&!g.page.row.selectEnabled){$A.addClass(m.table,g.gridReadOnlyClass)}}}m.thead=$A.createEl("thead",{role:"rowgroup",id:m.theadId,"aria-owns":m.trId});m.tbody=$A.createEl("tbody",{role:"rowgroup",id:m.tbodyId});m.tr=$A.createEl("tr",{role:"row",id:m.trId},null,g.gridRowClass);m.table.appendChild(m.thead);m.table.appendChild(m.tbody);m.thead.appendChild(m.tr);var p=[];for(var n=0;n<g.colHeaders.map.length;n++){d++;var r=g.colHeaders.map[n],q=$A.createEl("th",{role:"columnheader",id:b+"th"+d,scope:"col","aria-labelledby":b+"th"+d+"s",tabindex:"-1"},null,g.gridCellClass);g.colHeaders.map[n].thId=b+"th"+d;p.push(b+"th"+d);if(r.colClass){$A.addClass(q,r.colClass)}$A.bind(q,"click",function(o){g.page.row.move()});q.innerHTML='<strong id="'+b+"th"+d+'s"><span>'+a(r.name)+"</span></strong>";m.tr.appendChild(q)}$A.setAttr(m.tr,"aria-owns",p.join(" "));m.containerDiv.appendChild(m.table)},runBeforeClose:function(m){if(m.table){c(m.table).remove()}m.table=m.thead=m.tbody=m.tr=null}}]);g.dc=$A.reg[h];i.id=h;i.getAccDCObject=function(){return g.dc};i.container=f;i.mapColumnNames=function(m){if(!m||typeof m!=="object"&&!m.length){return}g.colHeaders.map=[];for(var p=0;p<m.length;p++){g.colHeaders.map.push({id:m[p].id,name:m[p].lbl,colClass:m[p].colClass||""})}};i.changeColumnOrder=function(m,n){if(isNaN(m)||isNaN(n)||!g.colHeaders.map[m]||n>=g.colHeaders.map.length){return}var p=g.colHeaders.map.splice(m,1);p.splice(0,0,n,0);[].splice.apply(g.colHeaders.map,p)};i.enableRowHeaders=function(m,n){g.rowHeaders={enabled:m?true:false,id:n}};i.setRowMax=function(m){g.page.row.max=isNaN(m)?0:m};i.editable=function(m){g.edit=m?true:false};i.add=function(n){if(!e(n)){n=[n]}for(var m=0;m<n.length;m++){var o=n[m];if(!(!o||(isNaN(o.id)&&!o.id)||!o.cells)){if(o.id in g.page.row.collection){var p=$A.inArray(o.id,g.page.row.selected);if(p!==-1){g.page.row.selected.splice(p,1)}g.page.row.clean(g.page.row.collection[o.id]);c(g.page.row.collection[o.id].rowNode).remove();p=$A.inArray(o.id,g.page.row.collectionMap);if(p!==-1){g.page.row.collectionMap.splice(p,1)}delete g.page.row.collection[o.id]}g.page.row.build(o);g.page.row.collectionMap.push(o.id);g.page.row.collection[o.id]=o;g.page.sync()}}};i.setChangeListener=function(m){if(typeof m!=="function"){return}g.page.row.changed.cb=m};i.setPageChangeListener=function(m){if(typeof m!=="function"){return}g.page.on.change=m};i.setEditMaxLength=function(m){if(isNaN(m)){m=0}g.page.row.editMaxLength=m};i.setEditLoadListener=function(m){if(typeof m!=="function"){return}g.page.row.editLoad=m};i.setPageIndexChangeListener=function(m){if(typeof m!=="function"){return}g.page.indexChanged=m};i.setSelect=function(n,m){if(!n||typeof n!=="object"){return}if("enable" in n){g.page.row.selectEnabled=n.enable?true:false}if("toggleClass" in n){g.page.row.selectClass=n.toggleClass||"selected"}if("multiSelect" in n){g.page.row.multiSelect=n.multiSelect?true:false}if("ariaSelect" in n){g.page.row.ariaSelect=n.ariaSelect?true:false}if("preserve" in n){g.page.row.preserveSelect=n.preserve?true:false}if("callback" in n){g.page.row.select.cb=typeof n.callback==="function"?n.callback:null}};i.unselectAll=function(){g.page.row.unselectAll()};i.selectAll=function(){g.page.row.selectAll()};i.getSelected=function(){var m=[];for(var n=0;n<g.page.row.selected.length;n++){m.push(g.page.row.collection[g.page.row.selected[n]])}return m};i.select=function(n){if(!e(n)){n=[n]}for(var m=0;m<n.length;m++){var o=n[m],p=g.page.row.collection[o];if(p&&p.cells&&p.cells[g.colHeaders.map[0].id]){g.page.row.select(p.cells[g.colHeaders.map[0].id],true)}}};i.setDelete=function(m){if(!m||typeof m!=="object"){return}if("enable" in m){g.page.row.deleteRow.enabled=m.enable?true:false}if("callback" in m){g.page.row.deleteRow.callback.cb=typeof m.callback==="function"?m.callback:null}if("runBefore" in m){g.page.row.deleteRow.callback.runBefore=typeof m.runBefore==="function"?m.runBefore:null}if("runAfter" in m){g.page.row.deleteRow.callback.runAfter=typeof m.runAfter==="function"?m.runAfter:null}};i.deleteRows=function(m){if(g.page.row.deleteRow.enabled){if(m&&m.length){return g.page.row.deleteRow.callback(m)}else{return g.page.row.deleteRow.callback()}}return false};i.deleteAllRows=function(){if(g.page.row.deleteRow.enabled){return g.page.row.deleteRow.callback(g.page.row.collectionMap)}return false};i.setAccessibleText=function(m){if(!m||typeof m!=="object"){return}if("toggleButtonRole" in m){g.page.row.toggleButtonRole=m.toggleButtonRole}if("toggleButtonState" in m){g.page.row.toggleButtonState=m.toggleButtonState}if("disabledText" in m){g.page.row.disabledText=m.disabledText}if("editLinkAction" in m){g.page.row.editLinkAction=m.editLinkAction}if("pageRole" in m){g.page.pageRole=m.pageRole}if("editFieldTitle" in m){g.page.row.editFieldTitle=m.editFieldTitle}if("dblClickTitle" in m){g.page.row.dblClickTitle=m.dblClickTitle}if("selectState" in m){g.page.row.selectState=m.selectState}};i.setStaticClasses=function(m){if(!m||typeof m!=="object"){return}if("gridClass" in m){g.gridClass=m.gridClass}if("gridReadOnlyClass" in m){g.gridReadOnlyClass=m.gridReadOnlyClass}if("cellReadOnlyClass" in m){g.cellReadOnlyClass=m.cellReadOnlyClass}if("gridEditableClass" in m){g.gridEditableClass=m.gridEditableClass}if("gridSelectableClass" in m){g.gridSelectableClass=m.gridSelectableClass}if("gridRowClass" in m){g.gridRowClass=m.gridRowClass}if("gridCellClass" in m){g.gridCellClass=m.gridCellClass}if("gridCellToggleClass" in m){g.gridCellToggleClass=m.gridCellToggleClass}if("gridCellTogglePressedClass" in m){g.gridCellTogglePressedClass=m.gridCellTogglePressedClass}if("gridCellLinkClass" in m){g.gridCellLinkClass=m.gridCellLinkClass}if("gridRowFocusedClass" in m){g.gridRowFocusedClass=m.gridRowFocusedClass}if("gridCellFocusedClass" in m){g.gridCellFocusedClass=m.gridCellFocusedClass}if("editFieldClass" in m){g.editFieldClass=m.editFieldClass}};i.currentPage=function(){return g.page.current};i.totalPages=function(){return g.page.total};i.totalRows=function(){return g.page.row.collectionMap.length};i.openPage=function(o,m){if(isNaN(o)||o<1){return}g.page.open(o,m)};i.prevPage=function(){if(!g.dc.loaded){return}var m=j();g.page.prev(m,m.rowObject)};i.nextPage=function(){if(!g.dc.loaded){return}var m=j();g.page.next(m,m.rowObject)};i.firstPage=function(){if(!g.dc.loaded){return}var m=j();g.page.first(m,m.rowObject)};i.lastPage=function(){if(!g.dc.loaded){return}var m=j();g.page.last(m,m.rowObject)};i.setOpenListener=function(m){if(m&&typeof m==="function"){g.page.on.open=m}};i.setCloseListener=function(m){if(m&&typeof m==="function"){g.page.on.close=m}};i.setAddListener=function(m){if(m&&typeof m==="function"){g.page.on.add=m}};i.setRemoveListener=function(m){if(m&&typeof m==="function"){g.page.on.rem=m}};i.setMoveListener=function(m){if(m&&typeof m==="function"){g.page.row.move.cb=m}};i.getData=function(o,n,m){if(!o||!n||!m||!(o in g.page.row.collection)||!(n in g.page.row.collection[o].cells)){return null}return g.page.row.collection[o].cells[n].data[m]};i.setData=function(p,o,m,n){if(!p||!o||!m||!(p in g.page.row.collection)||!(o in g.page.row.collection[p].cells)){return}g.page.row.collection[p].cells[o].data[m]=n};i.getValue=function(n,m){if(!n||!m||!(n in g.page.row.collection)||!(m in g.page.row.collection[n].cells)){return null}return g.page.row.collection[n].cells[m].value};i.setValue=function(o,n,m){g.page.row.update(o,n,m,true)};i.setEditOffset=function(m){if(m&&typeof m==="function"){g.page.row.cellOffset=m}};i.open=function(m){g.page.open(m,true)};i.close=function(){g.page.close()};i.focus=function(){g.page.row.move()};var k=false;i.useDblClick=function(m){k=m?true:false};return i};var a=function(g,h){var j="";if(typeof g==="number"){j=g.toString()}else{j=g}var e=j.length,f=[];while(e--){var k=j[e].charCodeAt();if(j[e]!="\n"&&(k<65||k>127||(k>90&&k<97))){f[e]="&#"+k+";"}else{f[e]=j[e]}}return f.join("")}})($A.internal);